create database spark_ds_github location '/user/hive/warehouse/spark_ds_github.db'
set hive.metastore.max.typename.length=100000;
CREATE EXTERNAL TABLE spark_ds_github.github_analysis(
actor struct<avatar_url:string,display_login:string,gravatar_id:string,id:bigint,login:string,url:string>
,created_at string
,id string
,org struct<avatar_url:string,gravatar_id:string,id:bigint,login:string,url:string>
,payload struct<action:string,before:string,comment:struct<links:struct<html:struct<href:string>,pull_request:struct<href:string>,self:struct<href:string>>,author_association:string,body:string,commit_id:string,created_at:string,diff_hunk:string,html_url:string,id:bigint,in_reply_to_id:bigint,issue_url:string,line:bigint,original_commit_id:string,original_position:bigint,path:string,position:bigint,pull_request_review_id:bigint,pull_request_url:string,updated_at:string,url:string,`user`:struct<avatar_url:string,events_url:string,followers_url:string,following_url:string,gists_url:string,gravatar_id:string,html_url:string,id:bigint,login:string,organizations_url:string,received_events_url:string,repos_url:string,site_admin:boolean,starred_url:string,subscriptions_url:string,type:string,url:string>>,commits:array<struct<author:struct<email:string,name:string>,`distinct`:boolean,message:string,sha:string,url:string>>,description:string,distinct_size:bigint,forkee:struct<archive_url:string,archived:boolean,assignees_url:string,blobs_url:string,branches_url:string,clone_url:string,collaborators_url:string,comments_url:string,commits_url:string,compare_url:string,contents_url:string,contributors_url:string,created_at:string,default_branch:string,deployments_url:string,description:string,downloads_url:string,events_url:string,fork:boolean,forks:bigint,forks_count:bigint,forks_url:string,full_name:string,git_commits_url:string,git_refs_url:string,git_tags_url:string,git_url:string,has_downloads:boolean,has_issues:boolean,has_pages:boolean,has_projects:boolean,has_wiki:boolean,homepage:string,hooks_url:string,html_url:string,id:bigint,issue_comment_url:string,issue_events_url:string,issues_url:string,keys_url:string,labels_url:string,language:string,languages_url:string,license:struct<key:string,name:string,spdx_id:string,url:string>,merges_url:string,milestones_url:string,mirror_url:string,name:string,notifications_url:string,open_issues:bigint,open_issues_count:bigint,owner:struct<avatar_url:string,events_url:string,followers_url:string,following_url:string,gists_url:string,gravatar_id:string,html_url:string,id:bigint,login:string,organizations_url:string,received_events_url:string,repos_url:string,site_admin:boolean,starred_url:string,subscriptions_url:string,type:string,url:string>,private:boolean,public:boolean,pulls_url:string,pushed_at:string,releases_url:string,size:bigint,ssh_url:string,stargazers_count:bigint,stargazers_url:string,statuses_url:string,subscribers_url:string,subscription_url:string,svn_url:string,tags_url:string,teams_url:string,trees_url:string,updated_at:string,url:string,watchers:bigint,watchers_count:bigint>,head:string,issue:struct<assignee:struct<avatar_url:string,events_url:string,followers_url:string,following_url:string,gists_url:string,gravatar_id:string,html_url:string,id:bigint,login:string,organizations_url:string,received_events_url:string,repos_url:string,site_admin:boolean,starred_url:string,subscriptions_url:string,type:string,url:string>,assignees:array<struct<avatar_url:string,events_url:string,followers_url:string,following_url:string,gists_url:string,gravatar_id:string,html_url:string,id:bigint,login:string,organizations_url:string,received_events_url:string,repos_url:string,site_admin:boolean,starred_url:string,subscriptions_url:string,type:string,url:string>>,author_association:string,body:string,closed_at:string,comments:bigint,comments_url:string,created_at:string,events_url:string,html_url:string,id:bigint,labels:array<struct<color:string,default:boolean,id:bigint,name:string,url:string>>,labels_url:string,locked:boolean,milestone:struct<closed_at:string,closed_issues:bigint,created_at:string,creator:struct<avatar_url:string,events_url:string,followers_url:string,following_url:string,gists_url:string,gravatar_id:string,html_url:string,id:bigint,login:string,organizations_url:string,received_events_url:string,repos_url:string,site_admin:boolean,starred_url:string,subscriptions_url:string,type:string,url:string>,description:string,due_on:string,html_url:string,id:bigint,labels_url:string,number:bigint,open_issues:bigint,state:string,title:string,updated_at:string,url:string>,number:bigint,pull_request:struct<diff_url:string,html_url:string,patch_url:string,url:string>,repository_url:string,state:string,title:string,updated_at:string,url:string,`user`:struct<avatar_url:string,events_url:string,followers_url:string,following_url:string,gists_url:string,gravatar_id:string,html_url:string,id:bigint,login:string,organizations_url:string,received_events_url:string,repos_url:string,site_admin:boolean,starred_url:string,subscriptions_url:string,type:string,url:string>>,master_branch:string,member:struct<avatar_url:string,events_url:string,followers_url:string,following_url:string,gists_url:string,gravatar_id:string,html_url:string,id:bigint,login:string,organizations_url:string,received_events_url:string,repos_url:string,site_admin:boolean,starred_url:string,subscriptions_url:string,type:string,url:string>,number:bigint,pages:array<struct<action:string,html_url:string,page_name:string,sha:string,summary:string,title:string>>,pull_request:struct<links:struct<comments:struct<href:string>,commits:struct<href:string>,html:struct<href:string>,issue:struct<href:string>,review_comment:struct<href:string>,review_comments:struct<href:string>,self:struct<href:string>,statuses:struct<href:string>>,additions:bigint,assignee:struct<avatar_url:string,events_url:string,followers_url:string,following_url:string,gists_url:string,gravatar_id:string,html_url:string,id:bigint,login:string,organizations_url:string,received_events_url:string,repos_url:string,site_admin:boolean,starred_url:string,subscriptions_url:string,type:string,url:string>,assignees:array<struct<avatar_url:string,events_url:string,followers_url:string,following_url:string,gists_url:string,gravatar_id:string,html_url:string,id:bigint,login:string,organizations_url:string,received_events_url:string,repos_url:string,site_admin:boolean,starred_url:string,subscriptions_url:string,type:string,url:string>>,author_association:string,base:struct<label:string,ref:string,repo:struct<archive_url:string,archived:boolean,assignees_url:string,blobs_url:string,branches_url:string,clone_url:string,collaborators_url:string,comments_url:string,commits_url:string,compare_url:string,contents_url:string,contributors_url:string,created_at:string,default_branch:string,deployments_url:string,description:string,downloads_url:string,events_url:string,fork:boolean,forks:bigint,forks_count:bigint,forks_url:string,full_name:string,git_commits_url:string,git_refs_url:string,git_tags_url:string,git_url:string,has_downloads:boolean,has_issues:boolean,has_pages:boolean,has_projects:boolean,has_wiki:boolean,homepage:string,hooks_url:string,html_url:string,id:bigint,issue_comment_url:string,issue_events_url:string,issues_url:string,keys_url:string,labels_url:string,language:string,languages_url:string,license:struct<key:string,name:string,spdx_id:string,url:string>,merges_url:string,milestones_url:string,mirror_url:string,name:string,notifications_url:string,open_issues:bigint,open_issues_count:bigint,owner:struct<avatar_url:string,events_url:string,followers_url:string,following_url:string,gists_url:string,gravatar_id:string,html_url:string,id:bigint,login:string,organizations_url:string,received_events_url:string,repos_url:string,site_admin:boolean,starred_url:string,subscriptions_url:string,type:string,url:string>,private:boolean,pulls_url:string,pushed_at:string,releases_url:string,size:bigint,ssh_url:string,stargazers_count:bigint,stargazers_url:string,statuses_url:string,subscribers_url:string,subscription_url:string,svn_url:string,tags_url:string,teams_url:string,trees_url:string,updated_at:string,url:string,watchers:bigint,watchers_count:bigint>,sha:string,`user`:struct<avatar_url:string,events_url:string,followers_url:string,following_url:string,gists_url:string,gravatar_id:string,html_url:string,id:bigint,login:string,organizations_url:string,received_events_url:string,repos_url:string,site_admin:boolean,starred_url:string,subscriptions_url:string,type:string,url:string>>,body:string,changed_files:bigint,closed_at:string,comments:bigint,comments_url:string,commits:bigint,commits_url:string,created_at:string,deletions:bigint,diff_url:string,head:struct<label:string,ref:string,repo:struct<archive_url:string,archived:boolean,assignees_url:string,blobs_url:string,branches_url:string,clone_url:string,collaborators_url:string,comments_url:string,commits_url:string,compare_url:string,contents_url:string,contributors_url:string,created_at:string,default_branch:string,deployments_url:string,description:string,downloads_url:string,events_url:string,fork:boolean,forks:bigint,forks_count:bigint,forks_url:string,full_name:string,git_commits_url:string,git_refs_url:string,git_tags_url:string,git_url:string,has_downloads:boolean,has_issues:boolean,has_pages:boolean,has_projects:boolean,has_wiki:boolean,homepage:string,hooks_url:string,html_url:string,id:bigint,issue_comment_url:string,issue_events_url:string,issues_url:string,keys_url:string,labels_url:string,language:string,languages_url:string,license:struct<key:string,name:string,spdx_id:string,url:string>,merges_url:string,milestones_url:string,mirror_url:string,name:string,notifications_url:string,open_issues:bigint,open_issues_count:bigint,owner:struct<avatar_url:string,events_url:string,followers_url:string,following_url:string,gists_url:string,gravatar_id:string,html_url:string,id:bigint,login:string,organizations_url:string,received_events_url:string,repos_url:string,site_admin:boolean,starred_url:string,subscriptions_url:string,type:string,url:string>,private:boolean,pulls_url:string,pushed_at:string,releases_url:string,size:bigint,ssh_url:string,stargazers_count:bigint,stargazers_url:string,statuses_url:string,subscribers_url:string,subscription_url:string,svn_url:string,tags_url:string,teams_url:string,trees_url:string,updated_at:string,url:string,watchers:bigint,watchers_count:bigint>,sha:string,`user`:struct<avatar_url:string,events_url:string,followers_url:string,following_url:string,gists_url:string,gravatar_id:string,html_url:string,id:bigint,login:string,organizations_url:string,received_events_url:string,repos_url:string,site_admin:boolean,starred_url:string,subscriptions_url:string,type:string,url:string>>,html_url:string,id:bigint,issue_url:string,labels:array<struct<color:string,default:boolean,id:bigint,name:string,url:string>>,locked:boolean,maintainer_can_modify:boolean,merge_commit_sha:string,mergeable:boolean,mergeable_state:string,merged:boolean,merged_at:string,merged_by:struct<avatar_url:string,events_url:string,followers_url:string,following_url:string,gists_url:string,gravatar_id:string,html_url:string,id:bigint,login:string,organizations_url:string,received_events_url:string,repos_url:string,site_admin:boolean,starred_url:string,subscriptions_url:string,type:string,url:string>,milestone:struct<closed_at:string,closed_issues:bigint,created_at:string,creator:struct<avatar_url:string,events_url:string,followers_url:string,following_url:string,gists_url:string,gravatar_id:string,html_url:string,id:bigint,login:string,organizations_url:string,received_events_url:string,repos_url:string,site_admin:boolean,starred_url:string,subscriptions_url:string,type:string,url:string>,description:string,due_on:string,html_url:string,id:bigint,labels_url:string,number:bigint,open_issues:bigint,state:string,title:string,updated_at:string,url:string>,number:bigint,patch_url:string,rebaseable:boolean,requested_reviewers:array<struct<avatar_url:string,events_url:string,followers_url:string,following_url:string,gists_url:string,gravatar_id:string,html_url:string,id:bigint,login:string,organizations_url:string,received_events_url:string,repos_url:string,site_admin:boolean,starred_url:string,subscriptions_url:string,type:string,url:string>>,requested_teams:array<struct<description:string,id:bigint,members_url:string,name:string,permission:string,privacy:string,repositories_url:string,slug:string,url:string>>,review_comment_url:string,review_comments:bigint,review_comments_url:string,state:string,statuses_url:string,title:string,updated_at:string,url:string,`user`:struct<avatar_url:string,events_url:string,followers_url:string,following_url:string,gists_url:string,gravatar_id:string,html_url:string,id:bigint,login:string,organizations_url:string,received_events_url:string,repos_url:string,site_admin:boolean,starred_url:string,subscriptions_url:string,type:string,url:string>>,push_id:bigint,pusher_type:string,ref:string,ref_type:string,release:struct<assets:array<struct<browser_download_url:string,content_type:string,created_at:string,download_count:bigint,id:bigint,label:string,name:string,size:bigint,state:string,updated_at:string,uploader:struct<avatar_url:string,events_url:string,followers_url:string,following_url:string,gists_url:string,gravatar_id:string,html_url:string,id:bigint,login:string,organizations_url:string,received_events_url:string,repos_url:string,site_admin:boolean,starred_url:string,subscriptions_url:string,type:string,url:string>,url:string>>,assets_url:string,author:struct<avatar_url:string,events_url:string,followers_url:string,following_url:string,gists_url:string,gravatar_id:string,html_url:string,id:bigint,login:string,organizations_url:string,received_events_url:string,repos_url:string,site_admin:boolean,starred_url:string,subscriptions_url:string,type:string,url:string>,body:string,created_at:string,draft:boolean,html_url:string,id:bigint,name:string,prerelease:boolean,published_at:string,tag_name:string,tarball_url:string,target_commitish:string,upload_url:string,url:string,zipball_url:string>,size:bigint>
,public boolean
,repo struct<id:bigint,name:string,url:string>
,type string
) 
PARTITIONED BY(year int, month int) 
STORED AS ORC 
LOCATION '/user/hive/warehouse/spark_ds_github.db' 
TBLPROPERTIES ('orc.compress'='SNAPPY');

--FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. InvalidObjectException(message:Invalid column type name length 13774 exceeds max allowed length 2000, 